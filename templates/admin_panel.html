{% extends "base.html" %}

{% block title %}Admin Panel - QA Platform{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="dashboard-header">
        <h1><i class="fas fa-user-shield"></i> Admin Panel</h1>
        <p>Manage users, questions, and platform settings</p>
    </div>
    
    <!-- Admin Stats -->
    <div class="admin-stats-grid">
        <div class="stat-card stat-primary">
            <div class="stat-icon">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-content">
                <h3>Total Users</h3>
                <p class="stat-number">{{ total_users }}</p>
                <small>{{ students_count }} Students | {{ staff_count }} Staff</small>
            </div>
        </div>
        
        <div class="stat-card stat-success">
            <div class="stat-icon">
                <i class="fas fa-question-circle"></i>
            </div>
            <div class="stat-content">
                <h3>Total Questions</h3>
                <p class="stat-number">{{ total_questions }}</p>
                <small>{{ public_questions }} Public | {{ private_questions }} Private</small>
            </div>
        </div>
        
        <div class="stat-card stat-info">
            <div class="stat-icon">
                <i class="fas fa-reply"></i>
            </div>
            <div class="stat-content">
                <h3>Total Answers</h3>
                <p class="stat-number">{{ total_answers }}</p>
                <small>{{ answered_questions }} Questions Answered</small>
            </div>
        </div>
        
        <div class="stat-card stat-danger">
            <div class="stat-icon">
                <i class="fas fa-ban"></i>
            </div>
            <div class="stat-content">
                <h3>Blocked Users</h3>
                <p class="stat-number">{{ blocked_users }}</p>
                <small>Click to view details</small>
            </div>
        </div>
    </div>
    
    <!-- Admin Tabs -->
    <div class="admin-tabs">
        <button class="tab-btn active" onclick="switchTab('users')">
            <i class="fas fa-users"></i> User Management
        </button>
        <button class="tab-btn" onclick="switchTab('questions')">
            <i class="fas fa-question-circle"></i> Questions
        </button>
        <button class="tab-btn" onclick="switchTab('blocked')">
            <i class="fas fa-ban"></i> Blocked Users
        </button>
        <button class="tab-btn" onclick="switchTab('reports')">
            <i class="fas fa-chart-bar"></i> Reports
        </button>
    </div>
    
    <!-- Tab Content: User Management -->
    <div id="tab-users" class="tab-content active">
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-users"></i> All Users</h2>
                <div class="header-actions">
                    <input type="text" id="userSearch" placeholder="Search users..." 
                           class="search-input" onkeyup="searchUsers()">
                    <select id="userTypeFilter" class="filter-select" onchange="filterUsers()">
                        <option value="all">All Types</option>
                        <option value="student">Students</option>
                        <option value="staff">Staff</option>
                    </select>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Email</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Registered</th>
                                <th>Last Login</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            {% for user in all_users %}
                            <tr data-user-type="{{ user.user_type }}">
                                <td>{{ user.id }}</td>
                                <td>{{ user.email }}</td>
                                <td>
                                    <span class="badge badge-{{ 'primary' if user.user_type == 'student' else 'success' }}">
                                        {{ user.user_type.title() }}
                                    </span>
                                </td>
                                <td>
                                    {% if user.is_blocked %}
                                    <span class="badge badge-danger">Blocked</span>
                                    {% elif user.is_verified %}
                                    <span class="badge badge-success">Active</span>
                                    {% else %}
                                    <span class="badge badge-warning">Pending</span>
                                    {% endif %}
                                </td>
                                <td>{{ user.created_at.strftime('%b %d, %Y') }}</td>
                                <td>{{ user.last_login.strftime('%b %d, %Y %I:%M %p') if user.last_login else 'Never' }}</td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-icon btn-info" onclick="viewUserDetails({{ user.id }})" title="View Details">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        {% if user.is_blocked %}
                                        <button class="btn-icon btn-success" onclick="unblockUser({{ user.id }})" title="Unblock">
                                            <i class="fas fa-unlock"></i>
                                        </button>
                                        {% else %}
                                        {% if user.user_type == 'student' %}
                                        <button class="btn-icon btn-danger" onclick="blockUser({{ user.id }})" title="Block">
                                            <i class="fas fa-ban"></i>
                                        </button>
                                        {% endif %}
                                        {% endif %}
                                        <button class="btn-icon btn-danger" onclick="deleteUser({{ user.id }})" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tab Content: Questions -->
    <div id="tab-questions" class="tab-content">
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-question-circle"></i> All Questions</h2>
                <div class="header-actions">
                    <select class="filter-select" onchange="filterQuestions(this.value)">
                        <option value="all">All Questions</option>
                        <option value="public">Public Only</option>
                        <option value="private">Private Only</option>
                        <option value="answered">Answered</option>
                        <option value="unanswered">Unanswered</option>
                    </select>
                </div>
            </div>
            <div class="card-body">
                <div id="questionsList">
                    {% for question in all_questions %}
                    <div class="admin-question-item" data-type="{{ 'public' if question.is_public else 'private' }}" 
                         data-status="{{ 'answered' if question.is_answered else 'unanswered' }}">
                        <div class="question-header">
                            <div class="question-meta">
                                <span class="question-id">#{{ question.id }}</span>
                                <span class="question-badge {{ 'public' if question.is_public else 'private' }}">
                                    <i class="fas fa-{{ 'globe' if question.is_public else 'lock' }}"></i>
                                    {{ 'Public' if question.is_public else 'Private' }}
                                </span>
                                {% if question.is_answered %}
                                <span class="badge badge-success">
                                    <i class="fas fa-check"></i> Answered
                                </span>
                                {% else %}
                                <span class="badge badge-warning">
                                    <i class="fas fa-clock"></i> Pending
                                </span>
                                {% endif %}
                            </div>
                            <div class="question-actions">
                                <button class="btn-icon btn-danger" onclick="deleteQuestion({{ question.id }})" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="question-details">
                            <p><strong>Asked by:</strong> {{ question.author.email }} ({{ question.author.user_type.title() }})</p>
                            <p><strong>Date:</strong> {{ question.created_at.strftime('%b %d, %Y %I:%M %p') }}</p>
                            <p><strong>Question:</strong></p>
                            <div class="question-content">{{ question.content }}</div>
                            {% if question.answers %}
                            <div class="answers-preview">
                                <p><strong><i class="fas fa-reply"></i> Answers ({{ question.answers|length }}):</strong></p>
                                {% for answer in question.answers %}
                                <div class="answer-preview">
                                    <small><strong>{{ answer.answerer.email }}:</strong> {{ answer.content[:100] }}{% if answer.content|length > 100 %}...{% endif %}</small>
                                </div>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tab Content: Blocked Users -->
    <div id="tab-blocked" class="tab-content">
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-ban"></i> Blocked Users</h2>
            </div>
            <div class="card-body">
                {% if blocked_users_list %}
                <div class="table-responsive">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Student Email</th>
                                <th>Blocked By</th>
                                <th>Reason</th>
                                <th>Blocked Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for block in blocked_users_list %}
                            <tr>
                                <td>{{ block.student.email }}</td>
                                <td>{{ block.blocker.email }}</td>
                                <td>{{ block.reason or 'No reason provided' }}</td>
                                <td>{{ block.blocked_at.strftime('%b %d, %Y %I:%M %p') }}</td>
                                <td>
                                    <button class="btn btn-success btn-sm" onclick="unblockUser({{ block.student_id }})">
                                        <i class="fas fa-unlock"></i> Unblock
                                    </button>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p class="empty-state">
                    <i class="fas fa-check-circle"></i><br>
                    No blocked users
                </p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Tab Content: Reports -->
    <div id="tab-reports" class="tab-content">
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-chart-bar"></i> Platform Reports</h2>
            </div>
            <div class="card-body">
                <div class="reports-grid">
                    <!-- Activity Report -->
                    <div class="report-section">
                        <h3><i class="fas fa-chart-line"></i> Activity Overview</h3>
                        <div class="report-stats">
                            <div class="report-item">
                                <span class="report-label">Questions Today:</span>
                                <span class="report-value">{{ questions_today }}</span>
                            </div>
                            <div class="report-item">
                                <span class="report-label">Answers Today:</span>
                                <span class="report-value">{{ answers_today }}</span>
                            </div>
                            <div class="report-item">
                                <span class="report-label">New Users Today:</span>
                                <span class="report-value">{{ new_users_today }}</span>
                            </div>
                            <div class="report-item">
                                <span class="report-label">Active Users Today:</span>
                                <span class="report-value">{{ active_users_today }}</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Most Active Users -->
                    <div class="report-section">
                        <h3><i class="fas fa-trophy"></i> Most Active Students</h3>
                        <div class="leaderboard">
                            {% for student in top_students %}
                            <div class="leaderboard-item">
                                <span class="rank">{{ loop.index }}</span>
                                <span class="user-email">{{ student.email }}</span>
                                <span class="user-score">{{ student.question_count }} questions</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    
                    <!-- Most Active Staff -->
                    <div class="report-section">
                        <h3><i class="fas fa-star"></i> Most Active Teachers</h3>
                        <div class="leaderboard">
                            {% for staff in top_staff %}
                            <div class="leaderboard-item">
                                <span class="rank">{{ loop.index }}</span>
                                <span class="user-email">{{ staff.email }}</span>
                                <span class="user-score">{{ staff.answer_count }} answers</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    
                    <!-- Response Rate -->
                    <div class="report-section">
                        <h3><i class="fas fa-percentage"></i> Response Rate</h3>
                        <div class="report-stats">
                            <div class="report-item">
                                <span class="report-label">Questions Answered:</span>
                                <span class="report-value">{{ answered_percentage }}%</span>
                            </div>
                            <div class="report-item">
                                <span class="report-label">Avg Response Time:</span>
                                <span class="report-value">{{ avg_response_time }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- User Details Modal -->
<div id="userModal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2><i class="fas fa-user"></i> User Details</h2>
            <button class="close-modal" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body" id="userModalBody">
            <!-- User details will be loaded here -->
        </div>
    </div>
</div>

<style>
/* Admin Stats Grid */
.admin-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-card {
    background: white;
    border-radius: var(--border-radius-lg);
    padding: 1.5rem;
    box-shadow: var(--shadow-md);
    display: flex;
    gap: 1rem;
    align-items: center;
    transition: var(--transition);
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
}

.stat-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    color: white;
}

.stat-primary .stat-icon { background: linear-gradient(135deg, #667eea, #764ba2); }
.stat-success .stat-icon { background: linear-gradient(135deg, #10b981, #059669); }
.stat-info .stat-icon { background: linear-gradient(135deg, #3b82f6, #2563eb); }
.stat-danger .stat-icon { background: linear-gradient(135deg, #ef4444, #dc2626); }

.stat-content h3 {
    font-size: 0.9rem;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
}

.stat-number {
    font-size: 2rem;
    font-weight: bold;
    color: var(--text-primary);
    margin: 0;
}

.stat-content small {
    color: var(--text-light);
    font-size: 0.85rem;
}

/* Admin Tabs */
.admin-tabs {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;
    background: white;
    padding: 0.5rem;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow-sm);
}

.tab-btn {
    padding: 0.75rem 1.5rem;
    border: none;
    background: transparent;
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    transition: var(--transition);
    font-weight: 600;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.tab-btn:hover {
    background: var(--bg-secondary);
    color: var(--primary-color);
}

.tab-btn.active {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: white;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Card Header Actions */
.header-actions {
    display: flex;
    gap: 1rem;
    align-items: center;
}

.search-input {
    padding: 0.5rem 1rem;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: var(--border-radius-sm);
    background: rgba(255, 255, 255, 0.2);
    color: white;
    min-width: 250px;
}

.search-input::placeholder {
    color: rgba(255, 255, 255, 0.7);
}

.search-input:focus {
    outline: none;
    background: rgba(255, 255, 255, 0.3);
    border-color: white;
}

.filter-select {
    padding: 0.5rem 1rem;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: var(--border-radius-sm);
    background: rgba(255, 255, 255, 0.2);
    color: white;
    cursor: pointer;
}

.filter-select option {
    background: var(--bg-primary);
    color: var(--text-primary);
}

/* Admin Table */
.table-responsive {
    overflow-x: auto;
}

.admin-table {
    width: 100%;
    border-collapse: collapse;
    background: white;
}

.admin-table thead {
    background: var(--bg-secondary);
}

.admin-table th {
    padding: 1rem;
    text-align: left;
    font-weight: 600;
    color: var(--text-primary);
    border-bottom: 2px solid var(--border-color);
}

.admin-table td {
    padding: 1rem;
    border-bottom: 1px solid var(--border-color);
    color: var(--text-primary);
}

.admin-table tbody tr:hover {
    background: var(--bg-secondary);
}

.badge {
    padding: 0.25rem 0.75rem;
    border-radius: 15px;
    font-size: 0.85rem;
    font-weight: 600;
    display: inline-block;
}

.badge-primary { background: #dbeafe; color: #1e40af; }
.badge-success { background: #dcfce7; color: #166534; }
.badge-danger { background: #fee2e2; color: #991b1b; }
.badge-warning { background: #fef3c7; color: #92400e; }

/* Action Buttons */
.action-buttons {
    display: flex;
    gap: 0.5rem;
}

.btn-icon {
    padding: 0.5rem;
    border: none;
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    transition: var(--transition);
    font-size: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 35px;
    height: 35px;
}

.btn-icon.btn-info { background: #dbeafe; color: #1e40af; }
.btn-icon.btn-success { background: #dcfce7; color: #166534; }
.btn-icon.btn-danger { background: #fee2e2; color: #991b1b; }

.btn-icon:hover {
    transform: scale(1.1);
}

/* Admin Question Item */
.admin-question-item {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    margin-bottom: 1rem;
}

.question-meta {
    display: flex;
    gap: 1rem;
    align-items: center;
    flex-wrap: wrap;
}

.question-id {
    font-weight: bold;
    color: var(--primary-color);
}

.question-details {
    margin-top: 1rem;
}

.question-details p {
    margin-bottom: 0.5rem;
    color: var(--text-secondary);
}

.question-content {
    background: white;
    padding: 1rem;
    border-radius: var(--border-radius-sm);
    margin: 0.5rem 0;
    border-left: 4px solid var(--primary-color);
}

.answers-preview {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-color);
}

.answer-preview {
    background: white;
    padding: 0.75rem;
    border-radius: var(--border-radius-sm);
    margin-top: 0.5rem;
}

/* Reports */
.reports-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
}

.report-section {
    background: var(--bg-secondary);
    padding: 1.5rem;
    border-radius: var(--border-radius);
    border: 1px solid var(--border-color);
}

.report-section h3 {
    margin-bottom: 1rem;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.report-stats {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.report-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem;
    background: white;
    border-radius: var(--border-radius-sm);
}

.report-label {
    font-weight: 600;
    color: var(--text-secondary);
}

.report-value {
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--primary-color);
}

/* Leaderboard */
.leaderboard {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.leaderboard-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem;
    background: white;
    border-radius: var(--border-radius-sm);
}

.rank {
    width: 30px;
    height: 30px;
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
}

.user-email {
    flex: 1;
    font-weight: 500;
}

.user-score {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

/* Modal */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 3000;
}

.modal-content {
    background: white;
    border-radius: var(--border-radius-lg);
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
}

.modal-header {
    padding: 1.5rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.close-modal {
    background: none;
    border: none;
    font-size: 2rem;
    cursor: pointer;
    color: var(--text-secondary);
}

.modal-body {
    padding: 1.5rem;
}
</style>

<script>
// Tab Switching
function switchTab(tabName) {
    // Hide all tabs
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Remove active class from all buttons
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // Show selected tab
    document.getElementById(`tab-${tabName}`).classList.add('active');
    
    // Add active class to clicked button
    event.target.closest('.tab-btn').classList.add('active');
}

// Search Users
function searchUsers() {
    const searchTerm = document.getElementById('userSearch').value.toLowerCase();
    const rows = document.querySelectorAll('#usersTableBody tr');
    
    rows.forEach(row => {
        const email = row.cells[1].textContent.toLowerCase();
        if (email.includes(searchTerm)) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
}

// Filter Users
function filterUsers() {
    const filterValue = document.getElementById('userTypeFilter').value;
    const rows = document.querySelectorAll('#usersTableBody tr');
    
    rows.forEach(row => {
        const userType = row.getAttribute('data-user-type');
        if (filterValue === 'all' || userType === filterValue) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
}

// Filter Questions
function filterQuestions(filter) {
    const questions = document.querySelectorAll('.admin-question-item');
    
    questions.forEach(question => {
        const type = question.getAttribute('data-type');
        const status = question.getAttribute('data-status');
        
        if (filter === 'all') {
            question.style.display = 'block';
        } else if (filter === 'public' || filter === 'private') {
            question.style.display = type === filter ? 'block' : 'none';
        } else if (filter === 'answered' || filter === 'unanswered') {
            question.style.display = status === filter ? 'block' : 'none';
        }
    });
}

// View User Details
function viewUserDetails(userId) {
    fetch(`/admin/user/${userId}`)
        .then(response => response.json())
        .then(data => {
            const modalBody = document.getElementById('userModalBody');
            modalBody.innerHTML = `
                <div class="user-details">
                    <p><strong>Email:</strong> ${data.email}</p>
                    <p><strong>Type:</strong> ${data.user_type}</p>
                    <p><strong>Status:</strong> ${data.is_blocked ? 'Blocked' : 'Active'}</p>
                    <p><strong>Registered:</strong> ${data.created_at}</p>
                    <p><strong>Last Login:</strong> ${data.last_login || 'Never'}</p>
                    <p><strong>Questions Asked:</strong> ${data.questions_count}</p>
                    <p><strong>Answers Given:</strong> ${data.answers_count}</p>
                </div>
            `;
            document.getElementById('userModal').style.display = 'flex';
        })
        .catch(error => {
            alert('Error loading user details');
            console.error(error);
        });
}

// Close Modal
function closeModal() {
    document.getElementById('userModal').style.display = 'none';
}

// Block User
function blockUser(userId) {
    if (!confirm('Are you sure you want to block this user?')) return;
    
    const reason = prompt('Reason for blocking:') || 'Admin action';
    
    const formData = new FormData();
    formData.append('student_id', userId);
    formData.append('reason', reason);
    
    fetch('/block-student', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('User blocked successfully');
            location.reload();
        } else {
            alert(data.message);
        }
    })
    .catch(error => {
        alert('Error blocking user');
        console.error(error);
    });
}

// Unblock User
function unblockUser(userId) {
    if (!confirm('Are you sure you want to unblock this user?')) return;
    
    const formData = new FormData();
    formData.append('student_id', userId);
    
    fetch('/unblock-student', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('User unblocked successfully');
            location.reload();
        } else {
            alert(data.message);
        }
    })
    .catch(error => {
        alert('Error unblocking user');
        console.error(error);
    });
}

// Delete User
function deleteUser(userId) {
    if (!confirm('Are you sure you want to DELETE this user? This action cannot be undone!')) return;
    
    fetch(`/admin/delete-user/${userId}`, {
        method: 'DELETE'
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('User deleted successfully');
            location.reload();
        } else {
            alert(data.message);
        }
    })
    .catch(error => {
        alert('Error deleting user');
        console.error(error);
    });
}

// Delete Question
function deleteQuestion(questionId) {
    if (!confirm('Are you sure you want to delete this question?')) return;
    
    fetch(`/admin/delete-question/${questionId}`, {
        method: 'DELETE'
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Question deleted successfully');
            location.reload();
        } else {
            alert(data.message);
        }
    })
    .catch(error => {
        alert('Error deleting question');
        console.error(error);
    });
}
</script>
{% endblock %}
